function checkout() {
  const selectedEmployee = document.getElementById("employeeSelect").value;
  if (!selectedEmployee) {
    alert("กรุณาเลือกพนักงาน");
    return;
  }

  const now = new Date();
  const date = now.toISOString().split("T")[0];
  const time = now.toTimeString().split(" ")[0].substring(0, 5);

  const data = {
    employeeId: selectedEmployee.split("|")[0],
    employee: selectedEmployee.split("|")[1],
    date: date,
    time: time,
    location: "", // ถ้ามีพิกัดให้ใส่ตรงนี้
    earlyMinutes: 0
  };

  const callback = "handleCheckoutResponse";
  const url = `${scriptURL}?action=checkout&callback=${callback}`;

  fetchJsonp(url, {
    jsonpCallbackFunction: callback,
    timeout: 8000,
    jsonpCallback: "callback", // ← สำคัญ!
    method: 'GET',
    params: data
  })
  .then(response => response.json())
  .then(handleCheckoutResponse)
  .catch(err => {
    console.error("Checkout Error:", err);
    alert("ไม่สามารถเช็คเอาท์ได้");
  });
}
